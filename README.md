# TourBox Custom Controller

A <del>blazingly ðŸ”¥ fast ðŸš€</del> software provides a custom driver and key mapping utility for TourBox devices without the official software.
Only support tourbox lite, because I have only tourbox lite.

## Why making it

Because official software is locking the locale to simplified chinese for my cheap tourbox lite.

## AI disclosure

Serial command analyzed and python prototype scripts written by grok 3.
Most of the code is initially generated by gemini-cli.

## Features

- **Custom Key Mappings:** Remap any button, dial, or scroll wheel on your TourBox to any keyboard key or key combination.
- **Multiple Trigger Types:**
  - `on_press`: The action is triggered immediately when a key is pressed.
  - `on_hold`: The action is held down as long as the key is pressed.
  - `on_release`: The action is triggered when the key is released.
- **Support for Multiple Connection Types:**
  - Not sure if there are differences, the decision is on you
  - **Serial:** usbser driver.
  - **WinUSB:** WinUSB driver.
- **Cross-Platform:**
  - Built with Rust and `eframe`

## Configuration

The application is configured using a `config.json` file. You can specify a different configuration file using the `--config` command-line argument.

### Device Configuration

The `device` section of the config file determines how the application connects to your TourBox.

#### WinUSB

For a WinUSB connection, you need to provide the Vendor ID (VID) and Product ID (PID) of your device.

```json
{
  "device": {
    "winusb": {
      "vid": "0xCAFE",
      "pid": "0x4001"
    }
  }
}
```

#### Serial

For a serial connection, you need to provide the serial port name and baud rate.

```json
{
  "device": {
    "serial": {
      "serial_port": "COM3",
      "baud_rate": 115200
    }
  }
}
```

### Key Map Configuration

The `key_map` section defines the mapping between the raw hexadecimal codes sent by the TourBox and human-readable key names.

- `stateful`: For keys that have distinct press and release events (e.g., buttons).
- `stateless`: For keys that only have a single event type (e.g., scroll wheel movements).

```json
{
    "key_map": {
        "stateful": {
            "0x01": "TOP",
            "0x02": "TALL"
        },
        "stateless": {
            "0x01": "SCROLL_UP",
            "0x02": "SCROLL_DOWN"
        }
    }
}
```

### Key Mappings Configuration

The `mappings` section is where you define the actions that will be performed when a key or combination of keys is used.

- `keys`: The key or keys that trigger the action. Multiple keys can be combined with a `+`.
- `action`: The keyboard key or key combination to be sent to the operating system.
- `trigger`: The trigger type (`on_press`, `on_hold`, or `on_release`).

```json
{
    "mappings": [
        {
            "keys": "KNOB_BTN",
            "action": "X",
            "trigger": "on_press"
        },
        {
            "keys": "TOP+TALL",
            "action": "CTRL_L+SHIFT_L",
            "trigger": "on_hold"
        }
    ]
}
```

## Building and Running

To build and run the project, you will need to have the Rust toolchain installed.

1.  **Clone the repository:**

    ```bash
    git clone <repository-url>
    cd <repository-name>
    ```

2.  **Run the application:**

    ```bash
    cargo run -- --config config.json
    ```

You can replace `config.json` with the path to your desired configuration file.

