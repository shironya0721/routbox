# TourBox Custom Controller

A <del>blazingly ðŸ”¥ fast ðŸš€</del> software provides a custom driver and key mapping utility for TourBox devices without the official software.
Only support tourbox lite, because I have only tourbox lite.

## Why making it

Because official software is locking the locale to simplified chinese for my cheap tourbox lite.

## AI disclosure

Serial command analyzed and python prototype scripts written by grok 3.
Most of the code is initially generated by gemini-cli.

## Features

* Â  **Custom Key Mappings:** Remap any button, dial, or scroll wheel on your TourBox to any keyboard key or key combination.
* Â  **Multiple Trigger Types:**
Â  Â  * Â  `on_press`: The action is triggered immediately when a key is pressed.
Â  Â  * Â  `on_hold`: The action is held down as long as the key is pressed.
Â  Â  * Â  `on_release`: The action is triggered when the key is released.
* Â  **Support for Multiple Connection Types:**
Â  Â  * Not sure if there are differences, the decision is on you
Â  Â  * Â  **Serial:** usbser driver.
Â  Â  * Â  **WinUSB:** WinUSB driver.
* Â  **Cross-Platform:**
Â  Â  * Built with Rust and `eframe`

## Configuration

The application is configured using a `config.json` file. You can specify a different configuration file using the `--config` command-line argument.

### Device Configuration

The `device` section of the config file determines how the application connects to your TourBox.

#### WinUSB

For a WinUSB connection, you need to provide the Vendor ID (VID) and Product ID (PID) of your device.

```json
{
Â  "device": {
Â  Â  "winusb": {
Â  Â  Â  "vid": "0xCAFE",
Â  Â  Â  "pid": "0x4001"
Â  Â  }
Â  }
}
```

#### Serial

For a serial connection, you need to provide the serial port name and baud rate.

```json
{
Â  "device": {
Â  Â  "serial": {
Â  Â  Â  "serial_port": "COM3",
Â  Â  Â  "baud_rate": 115200
Â  Â  }
Â  }
}
```

### Key Map Configuration

The `key_map` section defines the mapping between the raw hexadecimal codes sent by the TourBox and human-readable key names.

* Â  `stateful`: For keys that have distinct press and release events (e.g., buttons).
* Â  `stateless`: For keys that only have a single event type (e.g., scroll wheel movements).

```json
"key_map": {
Â  Â  "stateful": {
Â  Â  Â  Â  "0x01": "TOP",
Â  Â  Â  Â  "0x02": "TALL"
Â  Â  },
Â  Â  "stateless": {
Â  Â  Â  Â  "0x01": "SCROLL_UP",
Â  Â  Â  Â  "0x02": "SCROLL_DOWN"
Â  Â  }
}
```

### Key Mappings Configuration

The `mappings` section is where you define the actions that will be performed when a key or combination of keys is used.

* Â  `keys`: The key or keys that trigger the action. Multiple keys can be combined with a `+`.
* Â  `action`: The keyboard key or key combination to be sent to the operating system.
* Â  `trigger`: The trigger type (`on_press`, `on_hold`, or `on_release`).

```json
"mappings": [
Â  Â  {
Â  Â  Â  Â  "keys": "KNOB_BTN",
Â  Â  Â  Â  "action": "X",
Â  Â  Â  Â  "trigger": "on_press"
Â  Â  },
Â  Â  {
Â  Â  Â  Â  "keys": "TOP+TALL",
Â  Â  Â  Â  "action": "CTRL_L+SHIFT_L",
Â  Â  Â  Â  "trigger": "on_hold"
Â  Â  }
]
```

## Building and Running

To build and run the project, you will need to have the Rust toolchain installed.

1. Â **Clone the repository:**

Â  Â  ```bash
Â  Â  git clone <repository-url>
Â  Â  cd <repository-name>
Â  Â  ```

2. Â **Run the application:**

Â  Â  ```bash
Â  Â  cargo run -- --config config.json
Â  Â  ```

You can replace `config.json` with the path to your desired configuration file.

